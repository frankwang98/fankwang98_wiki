> ğŸ˜*â˜…,Â°*:.â˜†(ï¿£â–½ï¿£)/$:*.Â°â˜…* ğŸ˜  
>  è¿™ç¯‡æ–‡ç« ä¸»è¦ä»‹ç»ros2ç¯å¢ƒå®‰è£…ä¸åŸºç¡€å…¥é—¨ã€‚  
>  **å­¦å…¶æ‰€ç”¨ï¼Œç”¨å…¶æ‰€å­¦ã€‚â€”â€”æ¢å¯è¶…**  
>  æ¬¢è¿æ¥åˆ°æˆ‘çš„åšå®¢ï¼Œä¸€èµ·å­¦ä¹ ï¼Œå…±åŒè¿›æ­¥ã€‚  
>  å–œæ¬¢çš„æœ‹å‹å¯ä»¥å…³æ³¨ä¸€ä¸‹ï¼Œä¸‹æ¬¡æ›´æ–°ä¸è¿·è·¯ğŸ¥

### ğŸ˜1. ros2ä»‹ç»

ROS 2 (Robot Operating System 2)æ˜¯ä¸€ä¸ªå¼€æºçš„æœºå™¨äººæ“ä½œç³»ç»Ÿï¼Œå®ƒæ˜¯ROSï¼ˆRobot Operating Systemï¼‰çš„ä¸‹ä¸€ä»£ç‰ˆæœ¬ã€‚å®ƒæä¾›äº†ä¸€ç³»åˆ—å·¥å…·ã€åº“å’Œçº¦å®šï¼Œç”¨äºæ„å»ºæœºå™¨äººåº”ç”¨ç¨‹åºã€‚ä¸ROS 1ç›¸æ¯”ï¼ŒROS 2å…·æœ‰æ›´å¼ºå¤§çš„åŠŸèƒ½ï¼Œæ›´å¥½çš„æ€§èƒ½å’Œæ›´å¥½çš„å¯é æ€§ã€‚

ROS 2é‡‡ç”¨åˆ†å¸ƒå¼æ¶ˆæ¯ä¼ é€’æœºåˆ¶ï¼Œå¯ä»¥åœ¨ä¸åŒçš„è®¡ç®—æœºä¸Šè¿›è¡Œé€šä¿¡ï¼Œå¹¶æ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€ï¼ŒåŒ…æ‹¬C++ã€Pythonã€Javaç­‰ã€‚ROS 2è¿˜æä¾›äº†æ›´å¥½çš„å®‰å…¨æ€§å’Œå®æ—¶æ€§ï¼Œä½¿å…¶é€‚ç”¨äºæ›´å¹¿æ³›çš„æœºå™¨äººåº”ç”¨åœºæ™¯ã€‚

ROS 2çš„æ ¸å¿ƒç»„ä»¶åŒ…æ‹¬ï¼š

> rclcppï¼šROSå®¢æˆ·ç«¯åº“ï¼Œåœ¨C++ä¸­ä½¿ç”¨ã€‚ rclpyï¼šROSå®¢æˆ·ç«¯åº“ï¼Œåœ¨Pythonä¸­ä½¿ç”¨ã€‚  
> rosidlï¼šæœåŠ¡æ¥å£å®šä¹‰è¯­è¨€ï¼Œç”¨äºæè¿°ROSæ¶ˆæ¯å’ŒæœåŠ¡ã€‚ rmwï¼šROSä¸­é—´ä»¶ï¼Œç”¨äºç®¡ç†èŠ‚ç‚¹ä¹‹é—´çš„é€šä¿¡ã€‚  
> ros2cliï¼šå‘½ä»¤è¡Œç•Œé¢å·¥å…·ï¼Œç”¨äºç®¡ç†ROS 2ç³»ç»Ÿã€‚

ROS2çš„ä¸€å¤§ç‰¹ç‚¹æ˜¯é›†æˆäº†DDSï¼Œæ”¯æŒçš„DDSæœ‰ï¼š

> Fast RTPSï¼šè¯¥å®ç°åŸºäºeProsimaçš„Fast RTPSåº“ï¼Œæ˜¯ROS 2é»˜è®¤çš„DDSå®ç°ã€‚Fast RTPSæ˜¯ä¸€ä¸ªé«˜æ€§èƒ½ã€å¯é çš„DDSå®ç°ï¼Œé‡‡ç”¨äº†å¿«é€Ÿåºåˆ—åŒ–æœºåˆ¶ï¼ˆFast Buffersï¼‰å’ŒåŠ¨æ€ç±»å‹æ”¯æŒï¼ˆDynamicTypesï¼‰ï¼Œæ”¯æŒå¤šç§å¹³å°å’Œç¼–ç¨‹è¯­è¨€ã€‚  
> Cyclone DDSï¼šè¯¥å®ç°ç”±ADLINKå¼€å‘ï¼Œæ˜¯å¦ä¸€ä¸ªé«˜æ€§èƒ½ã€å¼€æºçš„DDSå®ç°ã€‚Cyclone DDSæ”¯æŒå¤šç§å¹³å°å’Œç¼–ç¨‹è¯­è¨€ï¼Œå¹¶æä¾›äº†ä¸€äº›é«˜çº§åŠŸèƒ½ï¼Œå¦‚åˆ†å¸ƒå¼å®‰å…¨å’ŒQoSé…ç½®ã€‚  
> RTI Connext DDSï¼šè¯¥å®ç°ç”±Real-Time Innovationså…¬å¸å¼€å‘ï¼Œæ˜¯ä¸€ä¸ªå•†ä¸šçº§åˆ«çš„DDSå®ç°ã€‚RTI Connext DDSæä¾›äº†å¹¿æ³›çš„åŠŸèƒ½å’Œå·¥å…·ï¼Œå¦‚å®æ—¶ç›‘æµ‹ã€æ•…éšœè¯Šæ–­å’Œç½‘ç»œä¼˜åŒ–ç­‰ã€‚

### ğŸ˜Š2. ros2å®‰è£…

Ubuntu 18.04å¯ä»¥å®‰è£…`ROS 2 Dashing Diademata`å’Œ`ROS 2 Eloquent Elusor`ç‰ˆæœ¬ã€‚å»ºè®®ä½¿ç”¨`Eloquent`ç‰ˆæœ¬ï¼Œå› ä¸ºå®ƒæ˜¯æœ€æ–°çš„é•¿æœŸæ”¯æŒç‰ˆæœ¬ï¼Œå¹¶æä¾›äº†æ›´å¤šçš„åŠŸèƒ½å’Œæ”¹è¿›ã€‚

å°é±¼çš„å®‰è£…å‘½ä»¤ï¼š`wget http://fishros.com/install -O fishros && . fishros`

æ ¹æ®éœ€æ±‚é€‰æ‹©å¯¹åº”çš„ros2ç‰ˆæœ¬å³å¯ã€‚

### ğŸ˜†3. ros2åŸºç¡€ä½¿ç”¨

ç¤ºä¾‹æµ‹è¯•ï¼š

```bash
# å‘å¸ƒè®¢é˜…
ros2 run demo_nodes_cpp listener
ros2 run demo_nodes_cpp talker
# å°ä¹Œé¾Ÿ
ros2 run turtlesim turtlesim_node
ros2 run turtlesim turtle_teleop_key
# CLI
ros2 pkg list
ros2 node list
ros2 node info <node_name>
ros2 pkg create <package-name>  --build-type  {cmake,ament_cmake,ament_python}  --dependencies <ä¾èµ–åå­—> # åˆ›å»ºåŠŸèƒ½åŒ…
ros2 bag record /topic_name
rviz2
gazebo

```

ä»£ç æ¨¡æ¿ï¼š`https://github.com/mikeferguson/ros2_cookbook`

å›½å†…å‚è€ƒï¼š`https://fishros.com/d2lros2foxy/#/codebook/README`

---

cmakeå·¥ç¨‹å¼•ç”¨rclcppç¤ºä¾‹ï¼š

åˆ›å»ºmain.cppï¼Œå†™ä¸€ä¸ªhello_world_cppèŠ‚ç‚¹ç¤ºä¾‹ï¼š


```cpp
#include "rclcpp/rclcpp.hpp"
#include <iostream>

int main(int argc, char** argv)
{
    rclcpp::init(argc, argv);
    std::cout << "Hello ROS2!" << std::endl;
    rclcpp::spin(std::make_shared<rclcpp::Node>("hello_world_cpp"));
    return 0;
}

```

åˆ›å»ºCMakeLists.txtï¼Œå¼•ç”¨rclcppå¤´æ–‡ä»¶å’Œé“¾æ¥åº“ï¼š

```bash
cmake_minimum_required(VERSION 3.11)
project(main)

find_package(rclcpp REQUIRED)
add_executable(main main.cpp)
target_link_libraries(main rclcpp::rclcpp)

```

ç„¶åç¼–è¯‘å³å¯ï¼š

```bash
mkdir build && cd build
cmake ..
make
./main

```

---

å®‰è£…colconç¼–è¯‘å·¥å…·å¹¶æµ‹è¯•æ¡ˆä¾‹ï¼š

```bash
# å®‰è£…ç¼–è¯‘å·¥å…·
sudo apt-get install python3-colcon-common-extensions
# ä¸‹è½½æºç 
mkdir colcon_test && cd colcon_test
git clone https://ghproxy.com/https://github.com/ros2/examples src/examples -b eloquent
colcon build
# è¿è¡Œè‡ªå·±ç¼–è¯‘çš„èŠ‚ç‚¹
source install/setup.bash
ros2 run examples_rclcpp_minimal_subscriber subscriber_member_function
source install/setup.bash
ros2 run examples_rclcpp_minimal_publisher publisher_member_function

```

è¿è¡Œå¦‚ä¸‹ï¼š

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/988d48834bb643baa906931d7effcddc.png)  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/b6da332b404249b099e8e5dbb9d3f4ed.png)  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/1a17933fcec84990b19243323f70a1a8.png)


### ğŸ˜†4. ros2èŠ‚ç‚¹ç¼–å†™

#### ç®€å•çš„èŠ‚ç‚¹

ä¸‹é¢æ¼”ç¤ºä¸€ä¸ªROS2èŠ‚ç‚¹çš„åˆ›å»ºï¼š

```bash
# æ–°å»ºèŠ‚ç‚¹ç›®å½•
mkdir -p ros2_ws/src
# åˆ›å»ºåŠŸèƒ½åŒ…ï¼ˆament_cmakeç¼–è¯‘ï¼Œrclcppä¾èµ–ï¼‰
cd ros2_ws/src
ros2 pkg create name_of_pack --build-type ament_cmake --dependencies rclcpp
# åˆ›å»ºç¼–å†™main.cpp
touch name_of_pack/src/main.cpp
# ä¿®æ”¹ï¼ˆæœ«å°¾è¿½åŠ ï¼‰CMakeLists.txt
add_executable(RosNode src/main.cpp)
ament_target_dependencies(RosNode rclcpp)
install(TARGETS
  RosNode 
  DESTINATION lib/${PROJECT_NAME}
)
# ç¼–è¯‘è¿è¡Œ
colcon build
source install/setup.bash
ros2 run name_of_pack RosNode
# æµ‹è¯•
ros2 node list
ros2 node info /RosNode_2

```

```cpp
#include "rclcpp/rclcpp.hpp"

int main(int argc, char **argv)
{
    /* åˆå§‹åŒ–rclcpp */
    rclcpp::init(argc, argv);
    /* åˆ›å»ºèŠ‚ç‚¹ */
    auto node = std::make_shared<rclcpp::Node>("RosNode_2");
    /* æ‰“å°æ—¥å¿— */
    RCLCPP_INFO(node->get_logger(), "ros2èŠ‚ç‚¹å·²ç»å¯åŠ¨.");
    /* è¿è¡ŒèŠ‚ç‚¹ï¼Œå¹¶æ£€æµ‹é€€å‡ºä¿¡å· Ctrl+C */
    rclcpp::spin(node);
    /* åœæ­¢è¿è¡Œ */
    rclcpp::shutdown();
    return 0;
}

```

#### å‘å¸ƒè€…å’Œè®¢é˜…è€…

ä¸‹é¢åˆ›å»ºä¸€ä¸ªå‘å¸ƒè€…å’Œè®¢é˜…è€…ï¼š

```bash
# æ–°å»ºç›®å½•
mkdir -p mytest_ws/src
cd mytest_ws/src
ros2 pkg create subscribe_and_publish --build-type ament_cmake --dependencies rclcpp
touch subscribe_and_publish/src/publisher.cpp
touch subscribe_and_publish/src/subscriber.cpp
# CMakeLists.txt
find_package(rclcpp REQUIRED)
find_package(std_msgs REQUIRED)
add_executable(publisher src/publisher.cpp)
ament_target_dependencies(publisher rclcpp std_msgs)
add_executable(subscribe1 src/subscriber.cpp)
ament_target_dependencies(subscribe1 rclcpp std_msgs)

install(TARGETS
  publisher
  subscriber
  DESTINATION lib/${PROJECT_NAME}
)
# package.xml
  <depend>rclcpp</depend>
  <depend>std_msgs</depend>
# ç¼–è¯‘è¿è¡Œ
colcon build
ros2 run subscribe_and_publish publisher
ros2 run subscribe_and_publish subscriber

```


```cpp
// publisher.cpp
#include "rclcpp/rclcpp.hpp"
#include "std_msgs/msg/string.hpp"

class Publisher : public rclcpp::Node
{
public:
    // æ„é€ å‡½æ•°,å‚æ•°ä¸ºèŠ‚ç‚¹åç§°
    Publisher(std::string name) : Node(name)
    {
        RCLCPP_INFO(this->get_logger(), "å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯%s.", name.c_str());
        // åˆ›å»ºå‘å¸ƒè€…
        subscribe_and_publish_publisher_ = this->create_publisher<std_msgs::msg::String>("subscribe_and_publish", 10);
        // åˆ›å»ºå®šæ—¶å™¨ï¼Œ500msä¸ºå‘¨æœŸï¼Œå®šæ—¶å‘å¸ƒ
        timer_ = this->create_wall_timer(std::chrono::milliseconds(500), std::bind(&Publisher::timer_callback, this));
    }

private:
    void timer_callback()
    {
        // åˆ›å»ºæ¶ˆæ¯
        std_msgs::msg::String message;
        message.data = "1234";
        // æ—¥å¿—æ‰“å°
        RCLCPP_INFO(this->get_logger(), "Publishing: '%s'", message.data.c_str());
        // å‘å¸ƒæ¶ˆæ¯
        subscribe_and_publish_publisher_->publish(message);
    }
    // å£°åå®šæ—¶å™¨æŒ‡é’ˆ
    rclcpp::TimerBase::SharedPtr timer_;
    // å£°æ˜è¯é¢˜å‘å¸ƒè€…æŒ‡é’ˆ
    rclcpp::Publisher<std_msgs::msg::String>::SharedPtr subscribe_and_publish_publisher_;
};

int main(int argc, char **argv)
{
    rclcpp::init(argc, argv);
    /* äº§ç”Ÿä¸€ä¸ªçš„èŠ‚ç‚¹ */
    auto node = std::make_shared<Publisher>("publisher");
    /* è¿è¡ŒèŠ‚ç‚¹ï¼Œå¹¶æ£€æµ‹é€€å‡ºä¿¡å· */
    rclcpp::spin(node);
    rclcpp::shutdown();
    return 0;
}

```


```cpp
// subscriber.cpp
#include "rclcpp/rclcpp.hpp"
#include "std_msgs/msg/string.hpp"

class Subscribe : public rclcpp::Node
{
public:
    Subscribe(std::string name) : Node(name)
    {
        RCLCPP_INFO(this->get_logger(), "å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯%s.", name.c_str());
        // åˆ›å»ºä¸€ä¸ªè®¢é˜…è€…è®¢é˜…è¯é¢˜
        subscribe_and_publish_subscribe_ = this->create_subscription<std_msgs::msg::String>("subscribe_and_publish", 10, std::bind(&Subscribe::command_callback, this, std::placeholders::_1));
    }

private:
    // å£°æ˜ä¸€ä¸ªè®¢é˜…è€…
    rclcpp::Subscription<std_msgs::msg::String>::SharedPtr subscribe_and_publish_subscribe_;
    // æ”¶åˆ°è¯é¢˜æ•°æ®çš„å›è°ƒå‡½æ•°
    void command_callback(const std_msgs::msg::String::SharedPtr msg)
    {
        RCLCPP_INFO(this->get_logger(), "æ”¶åˆ°[%s]æŒ‡ä»¤", msg->data.c_str());
    };
};

int main(int argc, char **argv)
{
    rclcpp::init(argc, argv);
    /*äº§ç”Ÿä¸€ä¸ªçš„èŠ‚ç‚¹*/
    auto node = std::make_shared<Subscribe>("subscriber");
    /* è¿è¡ŒèŠ‚ç‚¹ï¼Œå¹¶æ£€æµ‹é€€å‡ºä¿¡å·*/
    rclcpp::spin(node);
    rclcpp::shutdown();
    return 0;
}

```

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/6567c240f1b5443ab60e194d3ffe3803.png)


ä»¥ä¸Šã€‚





