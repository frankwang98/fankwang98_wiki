> ğŸ˜*â˜…,Â°*:.â˜†(ï¿£â–½ï¿£)/$:*.Â°â˜…* ğŸ˜  
>  è¿™ç¯‡æ–‡ç« ä¸»è¦ä»‹ç»carlaä»¿çœŸç¯å¢ƒå®‰è£…ä¸è¿è¡Œã€‚  
>  **å­¦å…¶æ‰€ç”¨ï¼Œç”¨å…¶æ‰€å­¦ã€‚â€”â€”æ¢å¯è¶…**  
>  æ¬¢è¿æ¥åˆ°æˆ‘çš„åšå®¢ï¼Œä¸€èµ·å­¦ä¹ ï¼Œå…±åŒè¿›æ­¥ã€‚  
>  å–œæ¬¢çš„æœ‹å‹å¯ä»¥å…³æ³¨ä¸€ä¸‹ï¼Œä¸‹æ¬¡æ›´æ–°ä¸è¿·è·¯ğŸ¥

### ğŸ˜1. Carlaä»‹ç»

`Carla`æ˜¯ä¸€ä¸ªå¼€æºçš„æ— äººé©¾é©¶ä»¿çœŸå¹³å°ï¼Œç”¨äºè®­ç»ƒå’Œæµ‹è¯•è‡ªåŠ¨é©¾é©¶ç®—æ³•ã€‚å®ƒæä¾›é«˜åº¦å¯é…ç½®çš„åœºæ™¯å’Œä¼ æ„Ÿå™¨è®¾ç½®ï¼Œæ¨¡æ‹ŸåŸå¸‚ç¯å¢ƒå’Œäº¤é€šæƒ…å†µï¼Œä»¥å¸®åŠ©å¼€å‘è€…è¯„ä¼°ä»–ä»¬çš„è‡ªåŠ¨é©¾é©¶ç³»ç»Ÿåœ¨å„ç§ç°å®ä¸–ç•Œåœºæ™¯ä¸‹çš„è¡¨ç°ã€‚


`Carla`çš„ç›®æ ‡æ˜¯ä¸ºç ”ç©¶äººå‘˜ã€å·¥ç¨‹å¸ˆå’Œå­¦ç”Ÿæä¾›ä¸€ä¸ªçœŸå®çš„ä»¿çœŸç¯å¢ƒï¼Œä»¥ä¾¿å¿«é€Ÿè¿­ä»£å’Œæµ‹è¯•ä»–ä»¬çš„è‡ªåŠ¨é©¾é©¶ç®—æ³•ã€‚å®ƒæ”¯æŒåŸºäºPythonçš„APIï¼Œä½¿ç”¨æˆ·èƒ½å¤Ÿè½»æ¾åœ°ä¸ä»¿çœŸç¯å¢ƒè¿›è¡Œäº¤äº’ï¼Œå¹¶æ§åˆ¶è½¦è¾†ã€è·å–ä¼ æ„Ÿå™¨æ•°æ®ç­‰ã€‚


`Carla`å…·æœ‰é€¼çœŸçš„å›¾å½¢æ¸²æŸ“å’Œç‰©ç†æ¨¡æ‹Ÿèƒ½åŠ›ï¼Œå¯ä»¥æ¨¡æ‹Ÿè½¦è¾†çš„è¿åŠ¨ã€æ„ŸçŸ¥å’Œå†³ç­–è¿‡ç¨‹ã€‚å®ƒè¿˜æ”¯æŒå¤šä¸ªä¼ æ„Ÿå™¨ç±»å‹ï¼ŒåŒ…æ‹¬ç›¸æœºã€æ¿€å…‰é›·è¾¾å’Œé›·è¾¾ç­‰ï¼Œä»¥æä¾›ä¸°å¯Œçš„æ„ŸçŸ¥ä¿¡æ¯ã€‚ç”¨æˆ·å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚é…ç½®ä¼ æ„Ÿå™¨è®¾ç½®ï¼Œä»è€Œæ¨¡æ‹Ÿä¸åŒçš„ä¼ æ„Ÿå™¨å¸ƒå±€å’Œæ€§èƒ½ã€‚


`Carla`çš„ä¸»è¦ç‰¹ç‚¹å’ŒåŠŸèƒ½åŒ…æ‹¬ï¼š


> 1.çœŸå®æ„ŸåŸå¸‚ç¯å¢ƒï¼šCARLAæä¾›äº†ä¸€ä¸ªé«˜åº¦è¯¦ç»†ã€çœŸå®æ„Ÿçš„åŸå¸‚ç¯å¢ƒï¼ŒåŒ…æ‹¬åŸå¸‚è¡—é“ã€é«˜é€Ÿå…¬è·¯ã€äº¤å‰å£ã€åœè½¦åœºç­‰ã€‚è¿™ä¸ªåŸå¸‚ç¯å¢ƒåŸºäºOpenStreetMapæ•°æ®ç”Ÿæˆï¼Œå…·æœ‰ä¸°å¯Œçš„é“è·¯ç½‘ç»œå’Œå¤šæ ·åŒ–çš„äº¤é€šåœºæ™¯ã€‚

> 2.ä¸°å¯Œçš„è½¦è¾†å’Œä¼ æ„Ÿå™¨æ¨¡å‹ï¼šCARLAæ”¯æŒå„ç§ç±»å‹çš„è½¦è¾†æ¨¡å‹ï¼ŒåŒ…æ‹¬è½¿è½¦ã€å¡è½¦ã€è‡ªè¡Œè½¦ç­‰ï¼Œå¹¶æä¾›äº†å¤šç§ä¼ æ„Ÿå™¨æ¨¡å‹ï¼Œå¦‚ç›¸æœºã€æ¿€å…‰é›·è¾¾ã€é›·è¾¾å’ŒGPSç­‰ã€‚å¼€å‘è€…å¯ä»¥é€‰æ‹©é€‚åˆå…¶åº”ç”¨åœºæ™¯çš„è½¦è¾†å’Œä¼ æ„Ÿå™¨é…ç½®ã€‚

> 3.çœŸå®ç‰©ç†æ¨¡æ‹Ÿï¼šCARLAä½¿ç”¨å‡†ç¡®çš„ç‰©ç†æ¨¡æ‹Ÿæ¥æ¨¡æ‹Ÿè½¦è¾†çš„åŠ¨åŠ›å­¦è¡Œä¸ºå’Œä¼ æ„Ÿå™¨çš„æµ‹é‡æ•°æ®ã€‚è¿™ä½¿å¾—å¼€å‘è€…å¯ä»¥åœ¨è™šæ‹Ÿç¯å¢ƒä¸­è¿›è¡Œé«˜åº¦çœŸå®çš„æµ‹è¯•å’Œè¯„ä¼°ï¼Œè€Œæ— éœ€å®é™…è½¦è¾†å’Œä¼ æ„Ÿå™¨ã€‚

> 4.å¯æ‰©å±•çš„APIå’Œè„šæœ¬æ”¯æŒï¼šCARLAæä¾›äº†Python APIå’Œè„šæœ¬æ”¯æŒï¼Œä½¿å¼€å‘è€…èƒ½å¤Ÿé€šè¿‡ç¼–å†™Pythonä»£ç æ¥æ§åˆ¶å’Œç›‘è§†ä»¿çœŸåœºæ™¯ã€‚è¿™ä½¿å¾—å¼€å‘è€…å¯ä»¥è‡ªå®šä¹‰ç®—æ³•ã€æ”¶é›†æ•°æ®ã€è¿›è¡Œæ¨¡æ‹Ÿå®éªŒç­‰ã€‚

> 5.é«˜åº¦å¯å®šåˆ¶çš„åœºæ™¯å’Œäº¤é€šè®¾ç½®ï¼šCARLAå…è®¸å¼€å‘è€…è‡ªå®šä¹‰ä»¿çœŸåœºæ™¯ï¼ŒåŒ…æ‹¬äº¤é€šæµé‡ã€è¡Œäººè¡Œä¸ºã€å¤©æ°”æ¡ä»¶ç­‰ã€‚è¿™ä½¿å¾—å¼€å‘è€…å¯ä»¥æ¨¡æ‹Ÿå„ç§ç°å®ä¸–ç•Œçš„äº¤é€šåœºæ™¯ï¼Œå¹¶è¿›è¡Œè‡ªåŠ¨é©¾é©¶ç®—æ³•çš„æµ‹è¯•å’Œè¯„ä¼°ã€‚

é™¤äº†æä¾›ä»¿çœŸç¯å¢ƒå¤–ï¼ŒCarlaè¿˜æä¾›äº†ä¸€å¥—ä¸°å¯Œçš„APIå’Œå·¥å…·ï¼Œç”¨äºæ”¶é›†å’Œåˆ†æä»¿çœŸæ•°æ®ã€‚


`Carla`ç›¸å…³å­¦ä¹ èµ„æºï¼š



```bash
å®˜ç½‘ï¼šhttps://carla.org/
Githubï¼šhttps://github.com/carla-simulator/carla
Wikiï¼šhttps://carla.readthedocs.io/en/latest/
ä¸­æ–‡ç«™ï¼šhttps://www.carla.org.cn/#/
0.9.11-releaseç‰ˆæœ¬ï¼šhttps://github.com/carla-simulator/carla/releases/tag/0.9.11

```

### ğŸ˜Š2. carlaç¯å¢ƒé…ç½®


ç›´æ¥å®‰è£…`release 0.9.11`ç‰ˆæœ¬ï¼Œæ–¹ä¾¿åˆå¿«æ·ï¼æºç çœŸçš„ä¸çŸ¥é“è¦æŠ˜è…¾å¤šä¹…ã€‚


#### Windows


é¦–å…ˆå®‰è£…`DirectX`ï¼Œåœ¨è¯¥åœ°å€ä¸‹è½½å³å¯ï¼š`https://www.microsoft.com/en-us/download/confirmation.aspx?id=35`


ç„¶åä¸‹è½½0.9.11çš„windows releaseç‰ˆæœ¬ï¼Œå¦‚ä¸‹ï¼š


![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/358eab274bd24cb4ba1794da99dce82b.png)


åŒå‡»è¿è¡Œå³å¯ï¼š


![è¯·æ·»åŠ å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/4c7bd28141a14ee0a1ae2cedd6edc288.png)


è¿™é‡Œåœ¨windowsä¸‹æ¼”ç¤ºï¼Œå®‰è£…å¥½`python3.7`ç‰ˆæœ¬ï¼Œå¯é€šè¿‡`python -V`æŸ¥çœ‹ã€‚


å®‰è£…ä¾èµ–çš„pipåŒ…ï¼š`pip install numpy pygame networkx`


å®‰è£…`carlib`ï¼š



```bash
# æ‰“å¼€powershell
cd D:\WindowsNoEditor\PythonAPI\carla\dist
# å®‰è£…egg
easy_install .\carla-0.9.11-py3.7-win-amd64.egg

```

è¿è¡Œclientç«¯è„šæœ¬ï¼ˆå‰ææ˜¯serverç«¯è¦æ‰“å¼€ï¼Œä¹Ÿå°±æ˜¯åŒå‡»è¿è¡Œçš„é‚£ä¸ªï¼‰ï¼š



```bash
cd D:\WindowsNoEditor\PythonAPI\examples
python .\automatic_control.py	# è‡ªåŠ¨è¿è¡Œè½¦è¾†æ§åˆ¶

```

æ‰§è¡Œåçš„æ¼”ç¤ºå¦‚ä¸‹ï¼š


![è¯·æ·»åŠ å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/7eee02e11cfc48f8b601b853e5494ae2.png)


#### Ubuntu


Ubuntuå®‰è£…ç±»ä¼¼ï¼Œä¹Ÿæ˜¯å»ä¸‹è½½Ubuntuçš„`release`ç‰ˆæœ¬ï¼Œç„¶åè¿è¡Œå³å¯ã€‚



```bash
#è¿è¡ŒCarla
./CarlaUE4.sh
#åŠ 80ä¸ªéšæœºè½¦è¾†
cd ~/CARLA_0.9.11/PythonAPI/examples
./spawn_npc.py -n 80
#æ§åˆ¶å¤©æ°”å˜åŒ–
./dynamic_weather.py
#æ‰‹åŠ¨é©¾é©¶client
./manual_control.py

```

Qï¼šå‡ºç°carlaçš„time-out of 2000ms while waiting for the simulator  
 Aï¼šåœ¨manual\_control.pyåŠ ä¸€å¥`client=carla.Client(host='127.0.0.1', port=2000)`ï¼Œå¤šä¸ªclientæ—¶port+1


#### äºŒæ¬¡å¼€å‘


Carlaæ”¯æŒ`python`å’Œ`c++`äºŒæ¬¡å¼€å‘ï¼Œä½†å¥½åƒç”¨æºç ç¼–è¯‘çš„æ”¯æŒæ›´å¥½ç‚¹ã€‚


æˆ‘è¯•äº†ä¸‹C++åˆ›å»º`client`ç¤ºä¾‹ï¼ŒåŠ äº†å¥½å¤šåº“å’Œå¤´æ–‡ä»¶ï¼Œä¹Ÿæ²¡æœ‰è°ƒè¯•å¥½ã€‚


pythonçš„è¯äºŒæ¬¡å¼€å‘ä¼šå¥½ç‚¹ï¼Œå› ä¸ºæä¾›äº†ä¸€äº›pythonçš„`example`ï¼Œæ¯”å¦‚æ‰‹åŠ¨æ§åˆ¶ç¤ºä¾‹ï¼Œæ˜¯ç”¨é”®ç›˜æ§åˆ¶çš„ï¼Œä¹Ÿå¯ä»¥è¯»å–å…¶ä»–è¾“å…¥è®¾å¤‡æ¯”å¦‚æ–¹å‘ç›˜ã€æ‰‹æŸ„ç­‰ã€‚ç”¨pythonè¯»å–è¾“å…¥è®¾å¤‡ç¤ºä¾‹å¦‚ä¸‹ï¼š



```py
import pygame

# åˆå§‹åŒ–pygameå’Œjoystick
pygame.init()
pygame.joystick.init()

# æ£€æŸ¥æ˜¯å¦æœ‰æ¸¸æˆæ§åˆ¶å™¨è¿æ¥
if pygame.joystick.get_count() > 0:
    # åˆå§‹åŒ–ç¬¬ä¸€ä¸ªæ§åˆ¶å™¨
    joystick = pygame.joystick.Joystick(0)
    joystick.init()

try:
    while True:
        pygame.event.pump()

        # è·å–æ–¹å‘ç›˜çš„è½´ã€æŒ‰é’®æˆ–å¸½å­å¼€å…³çš„çŠ¶æ€
        axis0 = joystick.get_axis(0)
        axis1 = joystick.get_axis(1)
        axis2 = joystick.get_axis(2)

        # å¤„ç†è½´çš„çŠ¶æ€
        print("Axis0 value: ", axis0)
        print("Axis1 value: ", axis1)
        print("Axis2 value: ", axis2)

        # ç¡®ä¿å»¶è¿Ÿä»¥é¿å…è¿‡åº¦å ç”¨å¤„ç†å™¨
        pygame.time.wait(100)

except KeyboardInterrupt:
    # æ¸…ç†å¹¶é€€å‡º
    pygame.quit()

```

### ğŸ˜†3. carla-ros-bridgeå®‰è£…ä¸ä»¿çœŸ


æºç å®‰è£…æ­¥éª¤å¦‚ä¸‹ï¼š



```sh
mkdir -p ~/carla-ros-bridge/catkin_ws/src
cd ~/carla-ros-bridge
git clone https://github.com/carla-simulator/ros-bridge.git(0.9.11)
cd catkin_ws/src
ln -s ../../ros-bridge-0.9.11
source /opt/ros/melodic/setup.bash
cd ..

rosdep update
rosdep install --from-paths src --ignore-src -r

catkin_make

```

åŠ å…¥ç¯å¢ƒå˜é‡ï¼š



```sh
gedit ~/.bashrc
#### carla
export PYTHONPATH=$PYTHONPATH:/home/dev/CARLA_0.9.11/PythonAPI/carla/dist/carla-0.9.11-py2.7-linux-x86_64.egg

#### carla\_ros\_bridge
source ~/carla-ros-bridge/catkin_ws/devel/setup.bash

```

rosèŠ‚ç‚¹å¯åŠ¨ï¼š



```sh
#### Option 1: start the ros bridge
roslaunch carla_ros_bridge carla_ros_bridge.launch

#### Option 2: start the ros bridge together with RVIZ
roslaunch carla_ros_bridge carla_ros_bridge_with_rviz.launch

#### Option 3: start the ros bridge together with an example ego vehicle
roslaunch carla_ros_bridge carla_ros_bridge_with_example_ego_vehicle.launch

```

æ­¤å¤–ï¼Œä¹Ÿå¯ä»¥åšautowareä¸carlaçš„è”åˆä»¿çœŸï¼š


1. carla-ä»¿çœŸå¼•æ“ï¼ˆæœåŠ¡ç«¯ï¼‰
2. ros\_bridge-è½¦è¾†æ¨¡å‹å’ŒtopicèŠ‚ç‚¹ï¼ˆå®¢æˆ·ç«¯ï¼‰
3. autoware-è‡ªåŠ¨é©¾é©¶ç®—æ³•é›†åˆ


ä»¿çœŸæµç¨‹ï¼š



```sh
1.å¯åŠ¨carla-./CarlaUE4.sh 
2.å¯åŠ¨carla_ros_bridge-roslaunch carla_ros_bridge carla_ros_bridge_with_example_ego_vehicle.launch
3.å¯åŠ¨autoware-roslaunch runtime_manager runtime_manager.launch
4.è°ƒç”¨autowareä¸­çš„rvizï¼Œæ˜¾ç¤ºç›¸æœºå’Œé›·è¾¾ï¼ŒåŠç®—æ³•å¤„ç†åçš„ç»“æœ

```

å¯ä»¥å®ç°çš„åŠŸèƒ½ï¼š



```
1.å½•åˆ¶bag
2.éªŒè¯lidarèšç±»ç®—æ³•
3.é›·è¾¾å»ºå›¾
â€¦â€¦

```

å¦å¤–ï¼Œautowareä¹Ÿå¯ä»¥ä¸lgsvlè”åˆä»¿çœŸï¼Œautowareè‡ªå¸¦äº†æ¥å£ã€‚


> winå¯åŠ¨lgsvl-2019.4ï¼Œé€‰æ‹©autowareè½¦å’Œipï¼Œautowareå¯åŠ¨lgsvlçš„bridge.launch  
>  èƒ½å½•åˆ¶velodyneçš„ç‚¹äº‘bagï¼Œå‡ºç°è½¦æ‚¬ç©ºçš„é—®é¢˜ï¼Œæ¢äº†ä¸ªåœºæ™¯å¥½äº†


rosä¹Ÿèƒ½å’Œlgsvlè”åˆä»¿çœŸï¼Œä¹Ÿè¦å¯åŠ¨ä¸€ä¸ªrosbridgeï¼š



```sh
roslaunch rosbridge_server rosbridge_websocket.launch

```

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/6567c240f1b5443ab60e194d3ffe3803.png)


ä»¥ä¸Šã€‚





