> ğŸ˜*â˜…,Â°*:.â˜†(ï¿£â–½ï¿£)/$:*.Â°â˜…* ğŸ˜  
>  è¿™ç¯‡æ–‡ç« ä¸»è¦ä»‹ç»åŸºäºcjsonåº“çš„jsonæ•°æ®å¤„ç†ã€‚  
>  **æ— ä¸“ç²¾åˆ™ä¸èƒ½æˆï¼Œæ— æ¶‰çŒåˆ™ä¸èƒ½é€šã€‚â€”â€”æ¢å¯è¶…**  
>  æ¬¢è¿æ¥åˆ°æˆ‘çš„åšå®¢ï¼Œä¸€èµ·å­¦ä¹ ï¼Œå…±åŒè¿›æ­¥ã€‚  
>  å–œæ¬¢çš„æœ‹å‹å¯ä»¥å…³æ³¨ä¸€ä¸‹ï¼Œä¸‹æ¬¡æ›´æ–°ä¸è¿·è·¯ğŸ¥

### ğŸ˜1. cjsonä»‹ç»

é¡¹ç›®Githubåœ°å€ï¼š`https://github.com/DaveGamble/cJSON`

`cJSON`æ˜¯ä¸€ä¸ªè½»é‡çº§çš„ã€ç”¨äºCè¯­è¨€çš„JSONè§£æå’Œç”Ÿæˆåº“ã€‚å®ƒæä¾›äº†ä¸€ç»„ç®€å•æ˜“ç”¨çš„APIï¼Œå¯ä»¥æ–¹ä¾¿åœ°å°†JSONæ•°æ®è½¬æ¢ä¸ºCè¯­è¨€ä¸­çš„æ•°æ®ç»“æ„ï¼Œå¹¶èƒ½å°†Cè¯­è¨€ä¸­çš„æ•°æ®ç»“æ„è½¬æ¢ä¸ºJSONæ ¼å¼ã€‚

ä»¥ä¸‹æ˜¯cJSONåº“çš„ä¸€äº›ç‰¹ç‚¹å’ŒåŠŸèƒ½ï¼š

> 1. è½»é‡çº§ï¼šcJSONåº“çš„ä»£ç é‡è¾ƒå°ï¼Œæ²¡æœ‰å¤æ‚çš„ä¾èµ–å…³ç³»ï¼Œé€‚åˆåµŒå…¥å¼ç³»ç»Ÿæˆ–èµ„æºå—é™çš„ç¯å¢ƒä½¿ç”¨ã€‚

> 2. æ˜“äºä½¿ç”¨ï¼šcJSONåº“æä¾›äº†ç®€å•æ˜“æ‡‚çš„APIï¼Œå¯ä»¥æ–¹ä¾¿åœ°è§£æå’Œç”ŸæˆJSONæ•°æ®ã€‚

> 3. è§£æåŠŸèƒ½ï¼šcJSONåº“å¯ä»¥å°†JSONå­—ç¬¦ä¸²è§£æä¸ºCè¯­è¨€ä¸­çš„æ•°æ®ç»“æ„ï¼ŒåŒ…æ‹¬å¯¹è±¡ã€æ•°ç»„ã€å­—ç¬¦ä¸²ã€æ•°å­—ç­‰ã€‚æ‚¨å¯ä»¥ä½¿ç”¨APIå‡½æ•°æ¥è·å–å’Œä¿®æ”¹JSONä¸­çš„æ•°æ®ã€‚

> 4. ç”ŸæˆåŠŸèƒ½ï¼šcJSONåº“å¯ä»¥æ ¹æ®Cè¯­è¨€ä¸­çš„æ•°æ®ç»“æ„ç”Ÿæˆå¯¹åº”çš„JSONå­—ç¬¦ä¸²ã€‚æ‚¨å¯ä»¥ä½¿ç”¨APIå‡½æ•°åˆ›å»ºå¯¹è±¡ã€æ•°ç»„ï¼Œæ·»åŠ é”®å€¼å¯¹ï¼Œè®¾ç½®å±æ€§ç­‰ã€‚

> 5. å†…å­˜ç®¡ç†ï¼šcJSONåº“æä¾›äº†å†…å­˜ç®¡ç†åŠŸèƒ½ï¼Œå¯ä»¥åŠ¨æ€åˆ†é…å’Œé‡Šæ”¾å†…å­˜ï¼Œé¿å…å†…å­˜æ³„æ¼å’Œæº¢å‡ºé—®é¢˜ã€‚

> 6. è·¨å¹³å°æ”¯æŒï¼šcJSONåº“åœ¨ä¸åŒå¹³å°ä¸Šéƒ½æœ‰å¾ˆå¥½çš„å…¼å®¹æ€§ï¼Œå¯ä»¥åœ¨å¤šç§æ“ä½œç³»ç»Ÿå’Œç¼–è¯‘å™¨ç¯å¢ƒä¸‹ä½¿ç”¨ã€‚

### ğŸ˜Š2. ç¯å¢ƒé…ç½®

åœ¨å·¥ç¨‹ä¸­ï¼Œåªéœ€è¦åŒ…å«ä¸¤ä¸ªæ–‡ä»¶å³å¯ï¼š

### ğŸ˜†3. ä½¿ç”¨è¯´æ˜

#### è§£æjsonæ•°æ®

```cpp
#include <iostream>
extern "C" {
	#include <stdio.h>
	#include "cJSON.h"
}

// å®šä¹‰ä¸€ä¸ªJsonæ•°æ®
char *message =
"{                              \
    \"name\":\"XiaoMing\",   \
    \"age\": 22,                \
    \"weight\": 60,           \
    \"address\":                \
        {                       \
            \"country\": \"China\",\
            \"zip-code\": 111111\
        },                      \
    \"skill\": [\"c\", \"Java\", \"Python\"],\
    \"student\": false          \
}";

int main(void)
{
	// å®ä¾‹åŒ–
	cJSON* cjson_test = NULL;
	cJSON* cjson_name = NULL;
	cJSON* cjson_age = NULL;
	cJSON* cjson_weight = NULL;
	cJSON* cjson_address = NULL;
	cJSON* cjson_address_country = NULL;
	cJSON* cjson_address_zipcode = NULL;
	cJSON* cjson_skill = NULL;
	cJSON* cjson_student = NULL;
	int    skill_array_size = 0, i = 0;
	cJSON* cjson_skill_item = NULL;

	// è§£ææ•´æ®µJsonæ•°æ®
	cjson_test = cJSON_Parse(message);
	if (cjson_test == NULL)
	{
		printf("parse fail.\n");
		return -1;
	}

	// ä¾æ¬¡æ ¹æ®åç§°æå–JSONæ•°æ®ï¼ˆé”®å€¼å¯¹ï¼‰
	cjson_name = cJSON_GetObjectItem(cjson_test, "name");
	cjson_age = cJSON_GetObjectItem(cjson_test, "age");
	cjson_weight = cJSON_GetObjectItem(cjson_test, "weight");

	printf("name: %s\n", cjson_name->valuestring);
	printf("age:%d\n", cjson_age->valueint);
	printf("weight:%.1f\n", cjson_weight->valuedouble);

	// è§£æåµŒå¥—jsonæ•°æ® 
	cjson_address = cJSON_GetObjectItem(cjson_test, "address");
	cjson_address_country = cJSON_GetObjectItem(cjson_address, "country");
	cjson_address_zipcode = cJSON_GetObjectItem(cjson_address, "zip-code");
	printf("address-country:%s\naddress-zipcode:%d\n", cjson_address_country->valuestring, cjson_address_zipcode->valueint);

	// è§£ææ•°ç»„ 
	cjson_skill = cJSON_GetObjectItem(cjson_test, "skill");
	skill_array_size = cJSON_GetArraySize(cjson_skill);
	printf("skill:[");
	for (i = 0; i < skill_array_size; i++)
	{
		cjson_skill_item = cJSON_GetArrayItem(cjson_skill, i);
		printf("%s,", cjson_skill_item->valuestring);
	}
	printf("\b]\n");

	// è§£æå¸ƒå°”å‹æ•°æ®
	cjson_student = cJSON_GetObjectItem(cjson_test, "student");
	if (cjson_student->valueint == 0)
	{
		printf("student: false\n");
	}
	else
	{
		printf("student:error\n");
	}

	return 0;
}

```

#### å°è£…jsonæ•°æ®

```cpp
#include <iostream>
extern "C" {
#include <stdio.h>
#include "cJSON.h"
}

int main(void)
{
	cJSON* cjson_test = NULL;
	cJSON* cjson_address = NULL;
	cJSON* cjson_skill = NULL;
	char* str = NULL;

	/* åˆ›å»ºä¸€ä¸ªJSONæ•°æ®å¯¹è±¡(é“¾è¡¨å¤´ç»“ç‚¹) */
	cjson_test = cJSON_CreateObject();

	/* æ·»åŠ ä¸€æ¡å­—ç¬¦ä¸²ç±»å‹çš„JSONæ•°æ®(æ·»åŠ ä¸€ä¸ªé“¾è¡¨èŠ‚ç‚¹) */
	cJSON_AddStringToObject(cjson_test, "name", "XiaoMing");

	/* æ·»åŠ ä¸€æ¡æ•´æ•°ç±»å‹çš„JSONæ•°æ®(æ·»åŠ ä¸€ä¸ªé“¾è¡¨èŠ‚ç‚¹) */
	cJSON_AddNumberToObject(cjson_test, "age", 22);

	/* æ·»åŠ ä¸€æ¡æµ®ç‚¹ç±»å‹çš„JSONæ•°æ®(æ·»åŠ ä¸€ä¸ªé“¾è¡¨èŠ‚ç‚¹) */
	//cJSON_AddNumberToObject(cjson_test, "weight", 60); //æç¤ºæ‰¾ä¸åˆ°æ ‡è¯†ç¬¦

	/* æ·»åŠ ä¸€ä¸ªåµŒå¥—çš„JSONæ•°æ®ï¼ˆæ·»åŠ ä¸€ä¸ªé“¾è¡¨èŠ‚ç‚¹ï¼‰ */
	cjson_address = cJSON_CreateObject();
	cJSON_AddStringToObject(cjson_address, "country", "China");
	//cJSON_AddNumberToObject(cjson_address, "zip-code", 111111);
	cJSON_AddItemToObject(cjson_test, "address", cjson_address);

	/* æ·»åŠ ä¸€ä¸ªæ•°ç»„ç±»å‹çš„JSONæ•°æ®(æ·»åŠ ä¸€ä¸ªé“¾è¡¨èŠ‚ç‚¹) */
	cjson_skill = cJSON_CreateArray();
	cJSON_AddItemToArray(cjson_skill, cJSON_CreateString("C"));
	cJSON_AddItemToArray(cjson_skill, cJSON_CreateString("Java"));
	cJSON_AddItemToArray(cjson_skill, cJSON_CreateString("Python"));
	cJSON_AddItemToObject(cjson_test, "skill", cjson_skill);

	/* æ·»åŠ ä¸€ä¸ªå€¼ä¸º False çš„å¸ƒå°”ç±»å‹çš„JSONæ•°æ®(æ·»åŠ ä¸€ä¸ªé“¾è¡¨èŠ‚ç‚¹) */
	cJSON_AddFalseToObject(cjson_test, "student");

	/* æ‰“å°JSONå¯¹è±¡(æ•´æ¡é“¾è¡¨)çš„æ‰€æœ‰æ•°æ® */
	str = cJSON_Print(cjson_test);
	printf("%sn", str);

	return 0;
}

```

#### ä»æ–‡ä»¶ä¸­è§£æjson

```cpp
#include <stdio.h> 
#include <string.h> 
#include <sys/types.h> 
#include <stdlib.h> 
#include <unistd.h> 
#include<sys/stat.h> //stat
#include "cJSON.h" 
#define FILENAME "./map.json"

typedef struct 
{  
    int x;
    int y;
}arr;  
 

//è§£æä¸€ä¸ªç»“æ„æ•°ç»„ 
int cJSON_to_struct_array(char *text, arr worker[])  
{  
    cJSON *json,*arrayItem,*item,*object;  
    int i = 0;  
 
    json=cJSON_Parse(text);     //parse
    if (!json)  
    {  
        printf("Error before: [%s]n",cJSON_GetErrorPtr());  
    }  
    else 
    {  
        arrayItem=cJSON_GetObjectItem(json,"arr");  // è·å–jsonå¯¹è±¡ä¸­çš„arrèŠ‚ç‚¹
        if(arrayItem!=NULL)  
        {  
            int size=cJSON_GetArraySize(arrayItem);  //è·å–æ•°ç»„å¤§å°
            printf("cJSON_GetArraySize: size=%dn",size);  
 
            for(i=0;i<size;i++)  
            {  
                printf("i=%dn",i);  
                object=cJSON_GetArrayItem(arrayItem,i);  
 
                item=cJSON_GetObjectItem(object,"x"); // è·å–jsonå¯¹è±¡ä¸­çš„firstNameèŠ‚ç‚¹
                if(item!=NULL)  
                {  
                    printf("cJSON_GetObjectItem: type=%d, valueint is %dn",item->type,item->valueint);  
                    memcpy(worker[i].x,item->valueint,strlen(item->valueint));  
                }  
                else 
                {  
                    printf("cJSON_GetObjectItem: get age failedn");  
                }  
 
                item=cJSON_GetObjectItem(object,"y");  
                if(item!=NULL)  
                {  
                    printf("cJSON_GetObjectItem: type=%d, valueint=%dn",item->type,item->valueint);  
                    worker[i].y=item->valueint;  
                }  
                else 
                {  
                    printf("cJSON_GetObjectItem: get age failedn");  
                }  
            }  
        }  
  
    printf("nn");
        for(i=0;  i<sizeof(worker) / sizeof(worker[0]) ;i++)    //è·å–æ•°ç»„é•¿åº¦
        {  
            printf("i=%d",i);
            printf("x=%d,y=%dn",  
                    worker[i].x,  
                    worker[i].y);
        }  
 
        cJSON_Delete(json);  
    }  
    return 0;  
}  
 
 // æ–‡ä»¶å¤§å°
size_t get_file_size(const char *filepath)
{
   
    if(NULL == filepath)
        return 0;
    struct stat filestat;
    memset(&filestat,0,sizeof(struct stat));
    /*è·å–æ–‡ä»¶ä¿¡æ¯*/
    if(0 == stat(filepath,&filestat))
        return filestat.st_size;
    else
        return 0;
}

// è¯»å–æ–‡ä»¶
void read_file(char *filename)  
{  
     FILE *fp;  

     arr worker[4]={{0}};  

  /*get file size*/
    size_t size = get_file_size(filename);
    if(0 == size)
    {
        printf("get_file_size failed!!!n");
    }
        
    /*malloc memory*/
    char *buf = malloc(size+1);
    if(NULL == buf)
    {
        printf("malloc failed!!!n");
        
    }
    memset(buf,0,size+1);

    fp=fopen(filename,"rb");  

    fread(buf,1,size,fp);  
    fclose(fp);  
 
    printf("read file %s complete, size=%d.n",filename,size);  

    cJSON_to_struct_array(buf, worker);  
 
    free(buf);  
}  

// main
int main(int argc, char **argv)  
{  
 
    read_file(FILENAME);  

    // // å®ä¾‹åŒ–
	// cJSON* cjson_x = NULL;
	// cJSON* cjson_y = NULL;

    // // ä¾æ¬¡æ ¹æ®åç§°æå–JSONæ•°æ®ï¼ˆé”®å€¼å¯¹ï¼‰
	// cjson_x = cJSON_GetObjectItem(cjson_x, "x");
	// cjson_y = cJSON_GetObjectItem(cjson_y, "y");

    // printf("x:%dn", cjson_x->valueint);
    // printf("y:%dn", cjson_y->valueint);
 
    return 0;  
}  

```

#### jsonæ•°æ®å†™å…¥æ–‡ä»¶

```cpp
#include <iostream>
#include <fstream>
#include "cJSON.h"

int main()
{
    // åˆ›å»ºJSONå¯¹è±¡å¹¶è®¾ç½®æ•°æ®
    cJSON* root = cJSON_CreateObject();
    cJSON_AddStringToObject(root, "name", "John");
    cJSON_AddNumberToObject(root, "age", 30);
    cJSON_AddStringToObject(root, "city", "New York");

    // ç”ŸæˆJSONå­—ç¬¦ä¸²
    char* json_str = cJSON_Print(root);

    // æ‰“å¼€æ–‡ä»¶
    std::ofstream file("data.json");

    if (file.is_open()) {
        // å°†JSONå­—ç¬¦ä¸²å†™å…¥æ–‡ä»¶
        file << json_str;

        // å…³é—­æ–‡ä»¶
        file.close();

        std::cout << "JSON data has been written to file." << std::endl;
    }
    else {
        std::cerr << "Unable to open file for writing." << std::endl;
    }

    // é‡Šæ”¾å†…å­˜
    cJSON_Delete(root);
    free(json_str);

    return 0;
}

```

ä»¥ä¸Šã€‚