







> 
> ğŸ˜*â˜…,Â°*:.â˜†(ï¿£â–½ï¿£)/$:*.Â°â˜…* ğŸ˜  
>  è¿™ç¯‡æ–‡ç« ä¸»è¦ä»‹ç»Excelå¤„ç†åº“-libxlsxwriteré…ç½®ä½¿ç”¨ã€‚  
>  **æ— ä¸“ç²¾åˆ™ä¸èƒ½æˆï¼Œæ— æ¶‰çŒåˆ™ä¸èƒ½é€šã€‚â€”â€”æ¢å¯è¶…**  
>  æ¬¢è¿æ¥åˆ°æˆ‘çš„åšå®¢ï¼Œä¸€èµ·å­¦ä¹ ï¼Œå…±åŒè¿›æ­¥ã€‚  
>  å–œæ¬¢çš„æœ‹å‹å¯ä»¥å…³æ³¨ä¸€ä¸‹ï¼Œä¸‹æ¬¡æ›´æ–°ä¸è¿·è·¯ğŸ¥
> 
> 
> 




#### æ–‡ç« ç›®å½•


* + [:smirk:1. é¡¹ç›®ä»‹ç»](#smirk1__7)
	+ [:blush:2. ç¯å¢ƒé…ç½®](#blush2__27)
	+ [:satisfied:3. ä½¿ç”¨è¯´æ˜](#satisfied3__50)




### ğŸ˜1. é¡¹ç›®ä»‹ç»


é¡¹ç›®Githubåœ°å€ï¼š`https://github.com/jmcnamara/libxlsxwriter`


Wikiåœ°å€ï¼š`https://libxlsxwriter.github.io/`


libxlsxwriter æ˜¯ä¸€ä¸ªç”¨äºåˆ›å»º Microsoft Excel XLSX æ–‡ä»¶çš„Cåº“ã€‚å®ƒæä¾›äº†ä¸€ç³»åˆ—åŠŸèƒ½ï¼Œå¯ä»¥è®©æ‚¨é€šè¿‡ç¼–ç¨‹æ–¹å¼ç”ŸæˆåŒ…å«å•å…ƒæ ¼ã€å›¾è¡¨ã€æ ¼å¼åŒ–ç­‰å†…å®¹çš„ Excel æ–‡ä»¶ã€‚ä¸‹é¢æ˜¯ libxlsxwriter çš„ä¸€äº›ç‰¹ç‚¹å’ŒåŠŸèƒ½ï¼š



> 
> 1.è·¨å¹³å°æ€§ï¼šlibxlsxwriter å¯ä»¥åœ¨å¤šä¸ªæ“ä½œç³»ç»Ÿä¸Šå·¥ä½œï¼ŒåŒ…æ‹¬ Linuxã€macOS å’Œ Windowsã€‚
> 
> 
> 



> 
> 2.åˆ›å»º XLSX æ–‡æ¡£ï¼šå®ƒå…è®¸æ‚¨åˆ›å»º XLSX æ ¼å¼çš„ Excel æ–‡æ¡£ï¼Œæ”¯æŒ Excel 2007 åŠæ›´é«˜ç‰ˆæœ¬ã€‚
> 
> 
> 



> 
> 3.ä¸°å¯Œçš„åŠŸèƒ½ï¼šlibxlsxwriter æ”¯æŒåˆ›å»ºå·¥ä½œè¡¨ã€å•å…ƒæ ¼ã€å…¬å¼ã€å›¾è¡¨ã€æ¡ä»¶æ ¼å¼åŒ–ã€æ•°æ®ç­›é€‰ç­‰åŠŸèƒ½ã€‚
> 
> 
> 



> 
> 4.é«˜æ€§èƒ½ï¼šè¯¥åº“è¢«è®¾è®¡ä¸ºå…·æœ‰é«˜æ€§èƒ½ï¼Œåœ¨å¤§å‹æ•°æ®é›†çš„æƒ…å†µä¸‹ç”Ÿæˆé€Ÿåº¦å¿«ã€‚
> 
> 
> 



> 
> 5.æ”¯æŒå¤šç§æ ¼å¼å’Œæ ·å¼ï¼šæ‚¨å¯ä»¥è®¾ç½®å•å…ƒæ ¼çš„æ ¼å¼ã€å­—ä½“ã€é¢œè‰²ã€è¾¹æ¡†ã€èƒŒæ™¯ç­‰å±æ€§ï¼Œä»¥åŠåº”ç”¨æ•°å€¼æ ¼å¼ã€æ—¥æœŸæ ¼å¼ã€å…¬å¼å’Œå‡½æ•°ç­‰ã€‚
> 
> 
> 



> 
> 6.æ”¯æŒå›¾è¡¨ï¼šlibxlsxwriter å…è®¸æ‚¨åˆ›å»ºå„ç§ Excel å›¾è¡¨ï¼Œå¦‚æ¡å½¢å›¾ã€é¥¼å›¾ã€æŠ˜çº¿å›¾ç­‰ï¼Œå¹¶æ”¯æŒè‡ªå®šä¹‰å›¾è¡¨çš„æ ·å¼å’Œå±æ€§ã€‚
> 
> 
> 


ä½†æ˜¯è¦æ³¨æ„ï¼Œ`libxlsxwriter` åªèƒ½ç”¨äºåˆ›å»º XLSX æ–‡ä»¶ï¼Œä¸æ”¯æŒè¯»å–æˆ–ä¿®æ”¹ç°æœ‰çš„ Excel æ–‡ä»¶ã€‚ï¼ˆå¯ä»¥é€šè¿‡c++è‡ªå¸¦çš„æ–‡ä»¶å¤„ç†æ¥è¯»å–ï¼Œå¤„ç†åçš„æ•°æ®å†æ‰‹åŠ¨å¯¼å…¥åˆ°æœ€åçš„è¡¨ä¸­ï¼‰


### ğŸ˜Š2. ç¯å¢ƒé…ç½®


ä¸‹é¢è¿›è¡Œç¯å¢ƒé…ç½®ï¼š



```
# å®‰è£…ä¾èµ–
sudo apt-get install libxslt-dev
# ä¸‹è½½æºç 
git clone https://github.com/jmcnamara/libxlsxwriter
# ç¼–è¯‘
cd libxlsxwriter
make
sudo cp lib/libxlsxwriter.so.5 /usr/lib/libxlsxwriter.so.5
cd cmake
cmake ..
make 
sudo make install

```

ç¼–è¯‘è¿è¡Œï¼š



```
g++ -o main main.cpp -lxlsxwriter && ./main

```

### ğŸ˜†3. ä½¿ç”¨è¯´æ˜


ä¸‹é¢è¿›è¡Œä½¿ç”¨åˆ†æï¼š


åˆ›å»ºexcelå¹¶å†™å…¥ç¤ºä¾‹ï¼š



```
#include "xlsxwriter.h"

int main() {

    /\* Create a new workbook and add a worksheet. \*/
    lxw_workbook  \*workbook  = workbook\_new("demo.xlsx");
    lxw_worksheet \*worksheet = workbook\_add\_worksheet(workbook, NULL);

    /\* Add a format. \*/
    lxw_format \*format = workbook\_add\_format(workbook);

    /\* Set the bold property for the format \*/
    format\_set\_bold(format);

    /\* Change the column width for clarity. \*/
    worksheet\_set\_column(worksheet, 0, 0, 20, NULL);

    /\* Write some simple text. \*/
    worksheet\_write\_string(worksheet, 0, 0, "Hello", NULL);

    /\* Text with formatting. \*/
    worksheet\_write\_string(worksheet, 1, 0, "World", format);

    /\* Write some numbers. \*/
    worksheet\_write\_number(worksheet, 2, 0, 123,     NULL);
    worksheet\_write\_number(worksheet, 3, 0, 123.456, NULL);

    /\* Insert an image. \*/
    worksheet\_insert\_image(worksheet, 1, 2, "logo.png");

    workbook\_close(workbook);

    return 0;
}

```

å‚è€ƒæŸåšä¸»ï¼Œç”ŸæˆæŒ‡å®šä¸ªæ•°çš„uuidç¤ºä¾‹ï¼š



```
#include <chrono>
#include <condition\_variable>
#include <ctime>
#include <curl/curl.h>
#include <curl/easy.h>
#include <fstream>
#include <functional>
#include <future>
#include <iostream>
#include <iomanip>
#include <map>
#include <memory>
#include <mutex>
#include <random>
#include <stdio.h>
#include <string>
#include <uuid/uuid.h>
#include <vector>
#include "xlsxwriter.h"

// ref: https://www.cnblogs.com/Fred1987/p/17442487.html
// ç¼–è¯‘ï¼š g++ -o main main.cpp -lxlsxwriter -luuid -lpthread && ./main

std::string get\_time\_now(bool is_exact = false)
{
    std::chrono::time_point<std::chrono::high_resolution_clock> now = std::chrono::high_resolution_clock::now();
    time_t raw_time = std::chrono::high_resolution_clock::to\_time\_t(now);
    struct tm tm_info = \*localtime(&raw_time);
    std::stringstream ss;
    ss << std::put\_time(&tm_info, "%Y%m%d%H%M%S");
    if (is_exact)
    {
        std::chrono::seconds seconds = std::chrono::duration\_cast<std::chrono::seconds>(now.time\_since\_epoch());
        std::chrono::milliseconds mills = std::chrono::duration\_cast<std::chrono::milliseconds>(now.time\_since\_epoch());
        std::chrono::microseconds micros = std::chrono::duration\_cast<std::chrono::microseconds>(now.time\_since\_epoch());
        std::chrono::nanoseconds nanos = std::chrono::duration\_cast<std::chrono::nanoseconds>(now.time\_since\_epoch());
        std::uint64\_t mills_count = mills.count() - seconds.count() \* 1000;
        std::uint64\_t micros_count = micros.count() - mills.count() \* 1000;
        std::uint64\_t nanos_count = nanos.count() - micros.count() \* 1000;
        ss << "\_" << std::setw(3) << std::setfill('0') << std::to\_string(mills_count)
           << std::setw(3) << std::setfill('0') << std::to\_string(micros_count)
           << std::setw(3) << std::setfill('0') << std::to\_string(nanos_count);
    }
    return ss.str();
}

// generate uuid
char \*uuid_value = (char \*)malloc(40);
char \*get\_uuid\_value()
{
    uuid_t new_uuid;
    uuid\_generate(new_uuid);
    uuid\_unparse(new_uuid, uuid_value);
    return uuid_value;
}

void xlsxwriter\_excel(const int &len)
{
    lxw_workbook \*workbook = workbook\_new("uuid.xlsx");

    lxw_worksheet \*worksheet = workbook\_add\_worksheet(workbook, NULL);
    worksheet\_set\_column(worksheet,0,0,50,NULL); // è®¾ç½®åˆ—å®½

    // write header
    worksheet\_write\_string(worksheet, 0, 0, "Header", NULL);
    worksheet\_write\_string(worksheet, 0, 1, "Number", NULL);

    for (int row = 1; row <= len; row++)
    {
        worksheet\_write\_string(worksheet, row, 0, get\_uuid\_value(), NULL);
        worksheet\_write\_number(worksheet, row, 1, row, NULL);
    }

    workbook\_close(workbook);
    std::cout << get\_time\_now(true) << ",finish in " << __FUNCTION__ << std::endl;
}

int main(int agrs,char \*\*argv)
{
    xlsxwriter\_excel(atoi(argv[1])); // è¯»å–å‘½ä»¤è¡Œï¼Œç”Ÿæˆå‡ ä¸ªuuid
    return 0;
}

```

ç»“åˆCGALè®¡ç®—å‡ ä½•åº“å¯¹txtç‚¹é›†è¿›è¡Œå¤„ç†ï¼Œå¹¶å¤„ç†åçš„æ•°æ®å†™å…¥xlsxï¼Œç¤ºä¾‹ï¼š



```
#include <iostream>
#include <fstream>
#include <vector>
#include "xlsxwriter.h"
#include <CGAL/Exact\_predicates\_inexact\_constructions\_kernel.h>
#include <CGAL/Alpha\_shape\_2.h>

typedef CGAL::Exact_predicates_inexact_constructions_kernel K;
typedef K::Point_2 Point_2;

// ç¼–è¯‘ï¼š g++ -o main main.cpp -lxlsxwriter -lCGAL -lgmp && ./main

int main() {
    // 1. ä»æ–‡æœ¬æ–‡ä»¶ä¸­è¯»å– XY ç‚¹é›†
    std::ifstream inputFile("input.txt");
    if (!inputFile) {
        std::cout << "Failed to open input file." << std::endl;
        return 1;
    }

    std::vector<Point_2> points;
    double x, y;
    while (inputFile >> x >> y) {
        points.push\_back(Point\_2(x, y));
    }
    inputFile.close();

    // ...

    // 2. å°†å¤„ç†åçš„ç‚¹é›†å†™å…¥ xlsx æ–‡ä»¶ä¸­
    lxw_workbook\* workbook = workbook\_new("output.xlsx");
    lxw_worksheet\* worksheet = workbook\_add\_worksheet(workbook, NULL);

    int row = 0;
    for (const Point_2& point : points) {
        int col = 0;
        worksheet\_write\_number(worksheet, row, col++, CGAL::to\_double(point.x()), NULL);
        worksheet\_write\_number(worksheet, row, col, CGAL::to\_double(point.y()), NULL);
        row++;
    }

    workbook\_close(workbook);

    std::cout << "Output file has been generated." << std::endl;

    return 0;
}


```

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/6cbcd6c17cec4dba9bb3c0f895f02fa2.png)


ä»¥ä¸Šã€‚





