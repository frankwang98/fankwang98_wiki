







> 
> ğŸ˜*â˜…,Â°*:.â˜†(ï¿£â–½ï¿£)/$:*.Â°â˜…* ğŸ˜  
>  è¿™ç¯‡æ–‡ç« ä¸»è¦ä»‹ç»Linuxç«¯ALSAéŸ³é¢‘å¤„ç†åº“ã€‚  
>  **æ— ä¸“ç²¾åˆ™ä¸èƒ½æˆï¼Œæ— æ¶‰çŒåˆ™ä¸èƒ½é€šã€‚ã€‚â€”â€”æ¢å¯è¶…**  
>  æ¬¢è¿æ¥åˆ°æˆ‘çš„åšå®¢ï¼Œä¸€èµ·å­¦ä¹ ï¼Œå…±åŒè¿›æ­¥ã€‚  
>  å–œæ¬¢çš„æœ‹å‹å¯ä»¥å…³æ³¨ä¸€ä¸‹ï¼Œä¸‹æ¬¡æ›´æ–°ä¸è¿·è·¯ğŸ¥
> 
> 
> 




#### æ–‡ç« ç›®å½•


* + [:smirk:1. é¡¹ç›®ä»‹ç»](#smirk1__7)
	+ [:blush:2. ç¯å¢ƒé…ç½®](#blush2__25)
	+ [:satisfied:3. ä½¿ç”¨è¯´æ˜](#satisfied3__41)




### ğŸ˜1. é¡¹ç›®ä»‹ç»


é¡¹ç›®Githubåœ°å€ï¼š`https://github.com/alsa-project/alsa-lib`


ALSAï¼ˆAdvanced Linux Sound Architectureï¼‰æ˜¯Linuxæ“ä½œç³»ç»Ÿä¸Šçš„éŸ³é¢‘å¤„ç†æ¡†æ¶ã€‚å®ƒæä¾›äº†å¯¹éŸ³é¢‘è®¾å¤‡çš„æŠ½è±¡å’Œæ§åˆ¶ï¼Œä½¿åº”ç”¨ç¨‹åºèƒ½å¤Ÿä¸éŸ³é¢‘ç¡¬ä»¶è¿›è¡Œäº¤äº’ã€‚


ALSAåº“æ˜¯ALSAé¡¹ç›®çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒä¸ºå¼€å‘è€…æä¾›äº†ä¸€ç»„APIï¼ˆåº”ç”¨ç¨‹åºç¼–ç¨‹æ¥å£ï¼‰ï¼Œç”¨äºä¸éŸ³é¢‘è®¾å¤‡è¿›è¡Œé€šä¿¡ã€‚ä»¥ä¸‹æ˜¯ALSAåº“çš„ä¸€äº›ä¸»è¦ç‰¹ç‚¹å’ŒåŠŸèƒ½ï¼š



> 
> 1.éŸ³é¢‘è®¾å¤‡è®¿é—®ï¼šALSAåº“å…è®¸åº”ç”¨ç¨‹åºä»¥åº•å±‚çš„æ–¹å¼è®¿é—®éŸ³é¢‘ç¡¬ä»¶è®¾å¤‡ï¼Œå¦‚å£°å¡ã€éº¦å…‹é£ã€æ‰¬å£°å™¨ç­‰ã€‚å®ƒæä¾›äº†ä¸€å¥—ä¸°å¯Œçš„APIï¼Œç”¨äºæ‰“å¼€ã€å…³é—­ã€è¯»å–å’Œå†™å…¥éŸ³é¢‘è®¾å¤‡ã€‚
> 
> 
> 



> 
> 2.å¤šé€šé“æ”¯æŒï¼šALSAåº“æ”¯æŒå¤šé€šé“éŸ³é¢‘å¤„ç†ï¼Œå…è®¸åº”ç”¨ç¨‹åºåŒæ—¶å¤„ç†å¤šä¸ªéŸ³é¢‘æµï¼Œå¹¶åœ¨ä¸åŒçš„é€šé“ä¸Šè¿›è¡Œç‹¬ç«‹æ§åˆ¶å’Œå¤„ç†ã€‚è¿™å¯¹äºéŸ³é¢‘æ··éŸ³ã€ç©ºé—´å¤„ç†å’ŒéŸ³é¢‘å½•åˆ¶ç­‰åœºæ™¯éå¸¸æœ‰ç”¨ã€‚
> 
> 
> 



> 
> 3.ä½å»¶è¿ŸéŸ³é¢‘å¤„ç†ï¼šALSAåº“è¢«è®¾è®¡ä¸ºæ”¯æŒä½å»¶è¿ŸéŸ³é¢‘å¤„ç†ï¼Œè¿™å¯¹äºå®æ—¶éŸ³é¢‘åº”ç”¨ç¨‹åºï¼ˆå¦‚éŸ³é¢‘ç¼–è¾‘è½¯ä»¶ã€æ¸¸æˆå’Œç”µè¯ä¼šè®®ï¼‰è‡³å…³é‡è¦ã€‚å®ƒæä¾›äº†ä¸€äº›ç‰¹æ€§å’Œé…ç½®é€‰é¡¹ï¼Œå¸®åŠ©å‡å°‘éŸ³é¢‘ä¼ è¾“å’Œå¤„ç†çš„å»¶è¿Ÿã€‚
> 
> 
> 



> 
> 4.ç¡¬ä»¶æ§åˆ¶å’Œå‚æ•°è®¾ç½®ï¼šALSAåº“å…è®¸åº”ç”¨ç¨‹åºç›´æ¥è®¿é—®éŸ³é¢‘è®¾å¤‡çš„ç¡¬ä»¶æ§åˆ¶å‚æ•°ï¼Œå¦‚é‡‡æ ·ç‡ã€å£°é“æ•°ã€éŸ³é‡å’ŒéŸ³æ•ˆç­‰ã€‚å¼€å‘è€…å¯ä»¥ä½¿ç”¨ALSAåº“æ¥é…ç½®å’Œæ§åˆ¶éŸ³é¢‘è®¾å¤‡ä»¥æ»¡è¶³å…·ä½“éœ€æ±‚ã€‚
> 
> 
> 



> 
> 5.MIDIæ”¯æŒï¼šé™¤äº†éŸ³é¢‘å¤„ç†ï¼ŒALSAåº“è¿˜æä¾›äº†å¯¹MIDIï¼ˆMusical Instrument Digital Interfaceï¼‰è®¾å¤‡çš„æ”¯æŒã€‚å®ƒå…è®¸åº”ç”¨ç¨‹åºé€šè¿‡ALSA APIä¸MIDIè®¾å¤‡è¿›è¡Œé€šä¿¡ï¼Œå®ç°éŸ³ä¹åˆæˆã€éŸ³åºå™¨å’Œæ§åˆ¶å™¨ç­‰åŠŸèƒ½ã€‚
> 
> 
> 


ALSAåº“æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§ä¸”å¹¿æ³›ä½¿ç”¨çš„éŸ³é¢‘å¤„ç†å·¥å…·ï¼Œå¯ç”¨äºåˆ›å»ºå„ç§éŸ³é¢‘åº”ç”¨ç¨‹åºï¼ŒåŒ…æ‹¬éŸ³ä¹æ’­æ”¾å™¨ã€éŸ³é¢‘ç¼–è¾‘å™¨ã€è¯­éŸ³è¯†åˆ«å’Œåˆæˆç³»ç»Ÿç­‰ã€‚å®ƒæä¾›äº†çµæ´»çš„æ¥å£å’Œä¸°å¯Œçš„åŠŸèƒ½ï¼Œä½¿å¼€å‘è€…èƒ½å¤Ÿè½»æ¾åœ°ä¸éŸ³é¢‘è®¾å¤‡è¿›è¡Œäº¤äº’ï¼Œå¹¶å®ç°é«˜è´¨é‡çš„éŸ³é¢‘å¤„ç†ã€‚


### ğŸ˜Š2. ç¯å¢ƒé…ç½®


ä¸‹é¢è¿›è¡Œå®‰è£…è¿è¡Œï¼š



```
# aptå®‰è£…
sudo apt install libasound2-dev
# g++ç¼–è¯‘æ—¶ -lasound

```


```
# æºç ç¼–è¯‘
./configure
make 
sudo make install

```

### ğŸ˜†3. ä½¿ç”¨è¯´æ˜


éŸ³é‡æ§åˆ¶ç¤ºä¾‹ï¼š



```
#include <iostream>
#include <alsa/asoundlib.h>

int main() {
    // æ‰“å¼€é»˜è®¤éŸ³é¢‘è®¾å¤‡
    snd_mixer_t \*handle;
    int res = snd\_mixer\_open(&handle, 0);
    if (res < 0) {
        std::cerr << "æ— æ³•æ‰“å¼€éŸ³é¢‘è®¾å¤‡" << std::endl;
        return 1;
    }

    // è®¾ç½®éŸ³é¢‘è®¾å¤‡ä¸ºéé˜»å¡æ¨¡å¼
    res = snd\_mixer\_attach(handle, "default");
    if (res < 0) {
        std::cerr << "æ— æ³•é™„åŠ åˆ°éŸ³é¢‘è®¾å¤‡" << std::endl;
        snd\_mixer\_close(handle);
        return 1;
    }

    res = snd\_mixer\_selem\_register(handle, NULL, NULL);
    if (res < 0) {
        std::cerr << "æ— æ³•æ³¨å†ŒéŸ³é¢‘å…ƒç´ " << std::endl;
        snd\_mixer\_close(handle);
        return 1;
    }

    res = snd\_mixer\_load(handle);
    if (res < 0) {
        std::cerr << "æ— æ³•åŠ è½½éŸ³é¢‘è®¾å¤‡" << std::endl;
        snd\_mixer\_close(handle);
        return 1;
    }

    // è·å–é»˜è®¤éŸ³é¢‘å…ƒç´ 
    snd_mixer_selem_id_t \*sid;
    snd\_mixer\_selem\_id\_alloca(&sid);
    snd\_mixer\_selem\_id\_set\_index(sid, 0);
    snd\_mixer\_selem\_id\_set\_name(sid, "Master");

    snd_mixer_elem_t\* elem = snd\_mixer\_find\_selem(handle, sid);
    if (!elem) {
        std::cerr << "æ— æ³•æ‰¾åˆ°éŸ³é¢‘å…ƒç´ " << std::endl;
        snd\_mixer\_close(handle);
        return 1;
    }

    // è·å–éŸ³é‡èŒƒå›´
    long minVolume, maxVolume;
    snd\_mixer\_selem\_get\_playback\_volume\_range(elem, &minVolume, &maxVolume);

    // å¢åŠ éŸ³é‡
    long volume;
    snd\_mixer\_selem\_get\_playback\_volume(elem, SND_MIXER_SCHN_FRONT_LEFT, &volume);
    std::cout << "å½“å‰éŸ³é‡ï¼š" << volume << "/" << maxVolume << std::endl;

    long newVolume = volume + 10;  // å¢åŠ 10å•ä½çš„éŸ³é‡
    if (newVolume > maxVolume) {
        newVolume = maxVolume;
    }
    snd\_mixer\_selem\_set\_playback\_volume(elem, SND_MIXER_SCHN_FRONT_LEFT, newVolume);

    std::cout << "å¢åŠ éŸ³é‡åçš„éŸ³é‡ï¼š" << newVolume << "/" << maxVolume << std::endl;

    // å…³é—­éŸ³é¢‘è®¾å¤‡
    snd\_mixer\_close(handle);

    return 0;
}


```

ç¼–è¯‘è¿è¡Œï¼š



```
g++ volume_control.cpp -o volume_control -lasound
./volume_control

```

è¯»å–å¹¶æ’­æ”¾pcméŸ³é¢‘æ–‡ä»¶ï¼š



```
#include <alsa/asoundlib.h>

int main() {
    // æ‰“å¼€é»˜è®¤çš„éŸ³é¢‘è®¾å¤‡
    snd_pcm_t \*pcm;
    if (snd\_pcm\_open(&pcm, "default", SND_PCM_STREAM_PLAYBACK, 0) < 0) {
        printf("æ— æ³•æ‰“å¼€éŸ³é¢‘è®¾å¤‡\n");
        return -1;
    }

    // é…ç½®éŸ³é¢‘å‚æ•°
    snd\_pcm\_set\_params(pcm,
                       SND_PCM_FORMAT_S16_LE,   // é‡‡æ ·æ ¼å¼ä¸º16ä½å°ç«¯
                       SND_PCM_ACCESS_RW_INTERLEAVED,
                       2,                       // é€šé“æ•°ä¸º2ï¼ˆç«‹ä½“å£°ï¼‰
                       44100,                   // é‡‡æ ·ç‡ä¸º44100Hz
                       1,                        // ç²¾ç¡®åº¦ä¸º1å¾®ç§’
                       50000);                   // ç¼“å†²å¤§å°è®¾ç½®ä¸º50000å­—èŠ‚

    // è¯»å–éŸ³é¢‘æ•°æ®å¹¶æ’­æ”¾
    char buffer[1024];
    FILE\* file = fopen("audio.pcm", "rb");  // ä»¥äºŒè¿›åˆ¶åªè¯»æ–¹å¼æ‰“å¼€éŸ³é¢‘æ–‡ä»¶
    if (file) {
        while (!feof(file)) {
            size_t bytesRead = fread(buffer, 1, sizeof(buffer), file);
            snd\_pcm\_writei(pcm, buffer, bytesRead/4);  // å°†éŸ³é¢‘æ•°æ®å†™å…¥éŸ³é¢‘è®¾å¤‡
        }
        fclose(file);
    } else {
        printf("æ— æ³•æ‰“å¼€éŸ³é¢‘æ–‡ä»¶\n");
    }

    // å…³é—­éŸ³é¢‘è®¾å¤‡
    snd\_pcm\_drain(pcm);
    snd\_pcm\_close(pcm);

    return 0;
}


```

ç¼–è¯‘è¿è¡Œï¼š



```
g++ audio.cpp -o audio -lasound
./audio

```

mp3ä¸pcmæ ¼å¼è½¬æ¢ï¼š



```
# å¯ä»¥ç”¨ffmpegå‘½ä»¤è¡Œå·¥å…·
ffmpeg -i input.mp3 -f s16le -acodec pcm_s16le output.pcm
#-i input.mp3ï¼šæŒ‡å®šè¾“å…¥çš„MP3æ–‡ä»¶ã€‚
#-f s16leï¼šæŒ‡å®šè¾“å‡ºæ ¼å¼ä¸º16ä½æœ‰ç¬¦å·PCMæ•°æ®ã€‚
#-acodec pcm\_s16leï¼šé€‰æ‹©PCMç¼–ç å™¨ï¼ŒæŒ‡å®š16ä½æœ‰ç¬¦å·çš„é‡‡æ ·æ ¼å¼ã€‚

```

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/6cbcd6c17cec4dba9bb3c0f895f02fa2.png)


ä»¥ä¸Šã€‚





